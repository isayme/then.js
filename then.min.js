!function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof exports&&module.exports?exports=module.exports=e():t.Then=e()}(this,function(){"use strict";function t(n,o,u,i){function c(t){return function(e){return f?void 0:(f=!0,t.call(void 0,e))}}var f=!1;if(n===o)throw new TypeError("donot resolve promise itself.");var s=r(o)&&o.then;if(e(s))try{s.call(o,c(function(e){try{t(o,e,u,i)}catch(n){c(i(n))}}),c(i))}catch(a){c(i)(a)}else u(o)}var e=function(t){return"function"==typeof t},n=function(t){return t&&"object"==typeof t},r=function(t){return n(t)||e(t)},o=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},u=function(t){function n(t){if("pending"===o.status){o.value=t,o.status="fulfilled";for(var e=0,n=o.resolves.length;n>e;e++)o.resolves[e].call(void 0,t)}}function r(t){if("pending"===o.status){o.reason=t,o.status="rejected";for(var e=0,n=o.rejects.length;n>e;e++)o.rejects[e].call(void 0,t)}}if(!e(t))throw new TypeError("argument must be a function.");if(!(this instanceof u))return new u(t);var o=this;o.status="pending",o.resolves=[],o.rejects=[],t(n,r)};return u.reject=function(t){return new u(function(e,n){n(t)})},u.resolve=function(t){return new u(function(e){e(t)})},u.all=function(t){if(!o(t))throw new TypeError("argument must be a array.");return new u(function(e,n){function r(t){return function(n){o[t]=n,i++,i===u&&e(o)}}for(var o=[],u=t.length,i=0,c=0,f=t.length;f>c;c++)t[c].then(r(c),n)})},u.race=function(t){if(!o(t))throw new TypeError("argument must be a array.");return new u(function(e,n){for(var r=0,o=t.length;o>r;r++)t[r].then(e,n)})},u.prototype.then=function(n,r){var o=this,i=new u(function(u,c){function f(r){setTimeout(function(){if(e(n))try{var o=n(r);t(i,o,u,c)}catch(f){c(f)}else u(r)},0)}function s(n){setTimeout(function(){if(e(r))try{var o=r(n);t(i,o,u,c)}catch(f){c(f)}else c(n)},0)}"fulfilled"===o.status?f.call(void 0,o.value):"rejected"===o.status?s.call(void 0,o.reason):(o.resolves.push(f),o.rejects.push(s))});return i},u.prototype.catch=function(t){return this.then(void 0,t)},u});